/* Bubble */
#ks-bubble {
position: fixed;
bottom: 28px; right: 28px;
z-index: 9000;
width: 58px; height: 58px;
border-radius: 50%;
background: linear-gradient(135deg, #1658a1, #54c8da);
display: flex; align-items: center; justify-content: center;
cursor: pointer;
box-shadow: 0 6px 24px rgba(22,88,161,0.45);
transition: transform 0.3s ease, box-shadow 0.3s ease;
border: none;
}
#ks-bubble:hover { transform: scale(1.08); box-shadow: 0 10px 32px rgba(22,88,161,0.55); }
#ks-bubble svg { width: 26px; height: 26px; transition: opacity 0.2s; }
#ks-bubble .ic-close { display: none; }

/* Notification dot */
#ks-notif {
position: absolute;
top: 2px; right: 2px;
width: 14px; height: 14px;
border-radius: 50%;
background: #f43f5e;
border: 2px solid #fff;
animation: notif-pulse 2s ease-in-out infinite;
}
@keyframes notif-pulse { 0%,100%{transform:scale(1)} 50%{transform:scale(1.2)} }

/* Window */
#ks-window {
position: fixed;
bottom: 100px; right: 28px;
z-index: 8999;
width: 360px;
max-height: 540px;
background: #fff;
border-radius: 18px;
box-shadow: 0 20px 60px rgba(22,88,161,0.18), 0 4px 16px rgba(0,0,0,0.1);
display: flex; flex-direction: column;
overflow: hidden;
transform: scale(0.85) translateY(20px);
transform-origin: bottom right;
opacity: 0;
pointer-events: none;
transition: transform 0.3s cubic-bezier(0.34,1.56,0.64,1), opacity 0.25s ease;
}
#ks-window.open {
transform: scale(1) translateY(0);
opacity: 1;
pointer-events: all;
}

/* Header */
.ks-head {
background: linear-gradient(135deg, #1658a1 0%, #1d78c4 100%);
padding: 16px 18px;
display: flex; align-items: center; gap: 12px;
flex-shrink: 0;
}
.ks-head-av {
width: 42px; height: 42px;
border-radius: 50%;
background: rgba(255,255,255,0.2);
border: 2px solid rgba(84,200,218,0.6);
display: flex; align-items: center; justify-content: center;
font-size: 1.3rem;
flex-shrink: 0;
}
.ks-head-info { flex: 1; }
.ks-head-name {
font-family: 'Montserrat', sans-serif;
font-weight: 700; font-size: 0.92rem; color: #fff;
}
.ks-head-status {
font-size: 0.72rem; color: rgba(255,255,255,0.75);
display: flex; align-items: center; gap: 5px; margin-top: 2px;
}
.ks-online-dot { width: 6px; height: 6px; border-radius: 50%; background: #54c8da; display: inline-block; }
.ks-head-close {
background: rgba(255,255,255,0.15);
border: none; border-radius: 50%;
width: 30px; height: 30px;
display: flex; align-items: center; justify-content: center;
cursor: pointer; color: #fff; font-size: 1rem;
transition: background 0.2s;
}
.ks-head-close:hover { background: rgba(255,255,255,0.3); }

/* Messages */
#ks-msgs {
flex: 1;
overflow-y: auto;
padding: 16px 14px;
display: flex;
flex-direction: column;
gap: 10px;
background: #f6f9fd;
scroll-behavior: smooth;
}
#ks-msgs::-webkit-scrollbar { width: 4px; }
#ks-msgs::-webkit-scrollbar-thumb { background: #c8d8ee; border-radius: 2px; }

.ks-msg {
display: flex; gap: 8px; align-items: flex-end;
animation: msg-in 0.25s ease;
}
@keyframes msg-in { from{opacity:0;transform:translateY(8px)} to{opacity:1;transform:none} }

.ks-msg.user { flex-direction: row-reverse; }

.ks-msg-av {
width: 28px; height: 28px; border-radius: 50%;
background: linear-gradient(135deg, #1658a1, #54c8da);
display: flex; align-items: center; justify-content: center;
font-size: 0.8rem; flex-shrink: 0; color: #fff;
font-family: 'Montserrat', sans-serif; font-weight: 700;
}

.ks-bubble-msg {
max-width: 82%;
padding: 10px 14px;
border-radius: 16px;
font-family: 'Poppins', sans-serif;
font-size: 0.84rem;
line-height: 1.55;
}
.ks-msg.bot  .ks-bubble-msg {
background: #fff;
color: #333;
border-bottom-left-radius: 4px;
box-shadow: 0 2px 8px rgba(22,88,161,0.07);
}
.ks-msg.user .ks-bubble-msg {
background: linear-gradient(135deg, #1658a1, #1d78c4);
color: #fff;
border-bottom-right-radius: 4px;
}

/* Typing indicator */
.ks-typing .ks-bubble-msg {
background: #fff;
padding: 12px 16px;
display: flex; gap: 5px; align-items: center;
box-shadow: 0 2px 8px rgba(22,88,161,0.07);
}
.ks-dot {
width: 7px; height: 7px; border-radius: 50%;
background: #54c8da;
animation: typing-dot 1.2s ease-in-out infinite;
}
.ks-dot:nth-child(2) { animation-delay: 0.2s; }
.ks-dot:nth-child(3) { animation-delay: 0.4s; }
@keyframes typing-dot { 0%,80%,100%{transform:scale(0.7);opacity:0.5} 40%{transform:scale(1);opacity:1} }

/* Quick replies */
#ks-quick {
padding: 10px 14px 6px;
display: flex; flex-wrap: wrap; gap: 6px;
background: #f6f9fd;
flex-shrink: 0;
}
.ks-chip {
padding: 6px 13px;
border-radius: 100px;
background: #fff;
border: 1.5px solid #d0dff0;
font-size: 0.76rem;
font-family: 'Poppins', sans-serif;
font-weight: 500;
color: #1658a1;
cursor: pointer;
transition: all 0.2s;
white-space: nowrap;
}
.ks-chip:hover { background: #1658a1; color: #fff; border-color: #1658a1; }

/* Input */
.ks-input-row {
display: flex; align-items: center; gap: 8px;
padding: 12px 14px;
border-top: 1px solid #e4eaf3;
background: #fff;
flex-shrink: 0;
}
#ks-input {
flex: 1;
border: 1.5px solid #dce5f0;
border-radius: 100px;
padding: 9px 16px;
font-family: 'Poppins', sans-serif;
font-size: 0.85rem;
outline: none;
color: #333;
transition: border-color 0.2s;
}
#ks-input:focus { border-color: #1658a1; }
#ks-input::placeholder { color: #aaa; }
#ks-send {
width: 38px; height: 38px;
border-radius: 50%;
background: linear-gradient(135deg, #1658a1, #54c8da);
border: none; cursor: pointer;
display: flex; align-items: center; justify-content: center;
transition: transform 0.2s, box-shadow 0.2s;
flex-shrink: 0;
}
#ks-send:hover { transform: scale(1.08); box-shadow: 0 4px 14px rgba(22,88,161,0.4); }
#ks-send svg { width: 16px; height: 16px; }

.ks-footer-note {
text-align: center;
font-size: 0.67rem;
color: #aaa;
padding: 6px 0 10px;
font-family: 'Poppins', sans-serif;
background: #fff;
flex-shrink: 0;
}

@media (max-width: 400px) {
#ks-window { width: calc(100vw - 20px); right: 10px; bottom: 88px; }
#ks-bubble { bottom: 18px; right: 18px; }
}